(function(n){if(typeof define=="function"&&define.amd)define(["jquery"],n);else if(typeof exports=="object")n(require("jquery"));else{if(typeof jQuery=="undefined")throw"TacticEditor requires jQuery to be loaded first";n(jQuery)}})(function(n){function i(t,i){function s(n,t){return t.toLowerCase()}var u=n(t).data(),f={},e,o=new RegExp("^"+i.toLowerCase()+"([A-Z])"),r;i=new RegExp("^"+i.toLowerCase());for(r in u)u.hasOwnProperty(r)&&i.test(r)&&(e=r.replace(o,s),f[e]=u[r]);return f}var t=function(t,i){var f={},r=n(t).attr("id"),u="",h=!1,e=function(n){t.trigger(n)},s=function(){for(var u,s,c,l,f,a,v,y=[],o=1;o<=i.countrows;o++)for(u=1;u<=i.countcolumns;u++)a=o+"_"+u,f=r+"_"+a,c=n(t).find("#"+f),l=n(t).find('label[for="'+f+'"]'),v=c.prop("checked"),v&&(s={},n.each(l.data(),function(n,t){n!=="tooltip"&&n!=="target"&&n!=="toggle"&&(s[n]=t.toString())}),y.push(s));return n(t).find("#"+r+"_save").val(JSON.stringify(y)),h?e({type:"save"}):e({type:"initialized"}),!0},c=function(){for(var h,y=n("<table><\/table>"),p=n("<tbody><\/tbody>"),a,e,o,t,w,f,c,v,l=1;l<=i.countrows;l++){for(a=n("<tr><\/tr>"),h=1;h<=i.countcolumns;h++){e=n("<td><\/td>");v=l+"_"+h;c=r+"_"+v;o=n('<input type="checkbox">');o.attr("id",c);o.attr("value",v);o.on("change",function(){n(this).prop("checked")?n(this).closest("td").find("label").tooltip():n(this).closest("td").find("label").tooltip("destroy");s()});t=n("<label><\/label>");w=n('<div id="'+c+'_title"><\/div>');t.data("column",h);t.data("row",l);t.attr("for",c);e.append(o);t.append(w);e.append(t);f=n("<span><\/span>");f.addClass("fa fa-edit fm-edit btn");f.attr("data-target","#"+r+"_modal");f.attr("data-toggle","modal");e.append(f);f.on("click",function(){u=n(this).closest("td").find("input").attr("id")});t.on("click",function(){u=n(this).closest("td").find("input").attr("id")});a.append(e)}p.append(a)}return y.append(p),y},l=function(){var t=n('<input type="hidden" >');return t.attr("id",r+"_save"),t.attr("name",i.name),t},a=function(){var t=n("<div><\/div>");t.attr("id",r+"_modal");t.addClass("modal hide fade fm-tactic-modal");var f=n('<div class="form-horizontal"><\/div>'),o=n('<div class="row-fluid"><\/div>'),h=n('<div class="span12"><\/div>');o.append(h);f.append(o);t.append(f);var c=n('<div class="control-group"><\/div>'),l=n('<div class="control-label"><\/div>'),a=n('<div class="controls"><\/div>');n.each(i.editinputs,function(f,o){var p=l.clone(),w=a.clone(),v=c.clone(),y=o.label,h=o.input;h=n(h).attr("id",r+"_edit_"+o.key);h=n(h).attr("name","");y=n(y).attr("for",r+"_edit_"+o.key);p.append(y);w.append(h);v.append(p);v.append(w);t.find(".span12").append(v);t.find("select").chosen({disable_search_threshold:5,allow_single_deselect:!0,width:"220px"});try{t.find(".fmtoggle").bootstrapToggle()}catch(b){}try{t.find(".fmtouchspin").TouchSpin()}catch(b){}t.find("#"+n(h).attr("id")).on("change",function(){var r,t;u!==""&&(r=n(this).val(),n(this).attr("type")==="checkbox"&&(r=n(this).prop("checked")?1:0),e({type:"positionUpdating",label:n('label[for="'+u+'"]')}),n('label[for="'+u+'"]').data(o.key,r),t=r,n(this).hasClass("chzn-done")&&(t=n("#"+n(this).attr("id")+"_chzn > .chzn-single > span").text()),i.tooltipkey===o.key&&(n('label[for="'+u+'"]').attr("data-original-title",t),n('label[for="'+u+'"]').attr("title",t)),i.labelkey===o.key&&n('label[for="'+u+'"] > div').text(t),i.numberkey===o.key&&n('label[for="'+u+'"]').attr("data-number",t),e({type:"positionUpdated",label:n('label[for="'+u+'"]')}));s()})});t.on("show",function(){n.each(i.editinputs,function(t,i){if(n("#"+r+"_edit_"+i.key).attr("type")==="checkbox"){var f=n("#"+u).closest("td").find("label").data(i.key);f===1?n("#"+r+"_edit_"+i.key).bootstrapToggle("on"):n("#"+r+"_edit_"+i.key).bootstrapToggle("off")}else n("#"+r+"_edit_"+i.key).val(n("#"+u).closest("td").find("label").data(i.key)),n("#"+r+"_modal select").trigger("liszt:updated")})});return t},o=function(t,u,f){for(var c,o,p,h=1;h<=i.countrows;h++)for(c=1;c<=i.countcolumns;c++){var d=h+"_"+c,w=r+"_"+d,a=undefined,y=[],v=[],b=[];jQuery.each(t,function(n,t){t.row===h&&t.column===c&&y.push(t)});jQuery.each(u,function(n,t){t.row===h&&t.column===c&&v.push(t)});jQuery.each(f,function(n,t){t.row===h&&t.column===c&&b.push(t)});y.length>0?a=y[0]:v.length>0&&(a=v[0]);var g=a!=undefined,k=v.length>0||b.length>0||i.readonly,l=n("#"+w);g?l.prop("checked",!0):l.prop("checked",!1);k?(l.attr("disabled","disabled"),l.attr("readonly","readonly")):(l.prop("disabled",!1),l.prop("readonly",!1));o=n('label[for="'+w+'"]');o.attr("title","");o.attr("data-number","");p=o.find("div");p.text("");k?(o.attr("data-target","#"+r+"_modal"),o.attr("data-toggle","modal")):(o.attr("data-target",""),o.attr("data-toggle",""));o.removeData();a!=undefined?n.each(a,function(t,u){o.data(t,u);i.tooltipkey===t&&o.attr("title",u);i.labelkey===t&&(n("#"+r+"_edit_"+t).hasClass("chzn-done")&&(n("#"+r+"_edit_"+t).val(u),n("#"+r+"_modal select").trigger("liszt:updated"),u=n("#"+r+"_edit_"+t+"_chzn > .chzn-single > span").text()),p.text(u));i.numberkey===t&&o.attr("data-number",u)}):(o.data("column",c),o.data("row",h))}e({type:"positionsUpdated"});s()};return f.setValues=function(n){o(n,i.readonlypositions,i.disabledpositions);i.values=n},f.setReadOnlyPositions=function(n){o(i.values,n,i.disabledpositions);i.readonlypositions=n},f.setDisabledPositions=function(n){o(i.values,i.readonlypositions,n);i.disabledpositions=n},f.setAllPositions=function(n,t,r){o(n,t,r);i.disabledpositions=r;i.readonlypositions=t;i.values=n},n(t).hasClass("fm-tactic-editor")||n(t).addClass("fm-tactic-editor"),n(t).append(a()),n(t).append(c()),n(t).append(l()),o(i.values,i.readonlypositions,i.disabledpositions),h=!0,f};n.fn.TacticEditor=function(r){return this.each(function(){var u=n(this),f;u.data("TacticEditor")||(f=i(this,""),r=n.extend(!0,{},n.fn.TacticEditor.defaults,f,r),u.data("TacticEditor",t(u,r)))})};n.fn.TacticEditor.defaults={name:"",countrows:7,countcolumns:5,readonly:!1,disabledpositions:[{row:7,column:1},{row:7,column:2},{row:7,column:4},{row:7,column:5},{row:6,column:1},{row:6,column:2},{row:6,column:4},{row:6,column:5}],readonlypositions:[{row:7,column:3}],values:[],editinputs:[{key:"number",label:'<label title="Indiquez le num�ro par d�faut pour ce poste.">Num�ro<\/label>',input:'<input type="text" class="fmtouchspin fm-input-xxmini" id="jform_positions_editNumber">',isTooltip:!1}],tooltipkey:"",labelkey:"",numberkey:""}});
/*
//# sourceMappingURL=tacticeditor.min.js.map
*/