(function(n){n.easytabs=function(t,i){var u=this,f=n(t),v={animate:!0,panelActiveClass:"active",tabActiveClass:"active",defaultTab:"li:first-child",animationSpeed:"fast",tabs:"> ul > li",updateHash:!1,cycle:!1,collapsible:!1,collapsedClass:"collapsed",collapsedByDefault:!0,uiTabs:!1,transitionIn:"fadeIn",transitionOut:"fadeOut",transitionInEasing:"swing",transitionOutEasing:"swing",transitionCollapse:"slideUp",transitionUncollapse:"slideDown",transitionCollapseEasing:"swing",transitionUncollapseEasing:"swing",containerClass:"",tabsClass:"",tabClass:"",panelClass:"",cache:!0,event:"click",panelContext:f},e,h,o,c,s,y={fast:200,normal:400,slow:600},r;u.init=function(){u.settings=r=n.extend({},v,i);r.bind_str=r.event+".easytabs";r.uiTabs&&(r.tabActiveClass="ui-tabs-selected",r.containerClass="ui-tabs ui-widget ui-widget-content ui-corner-all",r.tabsClass="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all",r.tabClass="ui-state-default ui-corner-top",r.panelClass="ui-tabs-panel ui-widget-content ui-corner-bottom");r.collapsible&&i.defaultTab!==undefined&&i.collpasedByDefault===undefined&&(r.collapsedByDefault=!1);typeof r.animationSpeed=="string"&&(r.animationSpeed=y[r.animationSpeed]);n("a.anchor").remove().prependTo("body");f.data("easytabs",{});u.setTransitions();u.getTabs();p();w();k();nt();tt();f.attr("data-easytabs",!0)};u.setTransitions=function(){o=r.animate?{show:r.transitionIn,hide:r.transitionOut,speed:r.animationSpeed,collapse:r.transitionCollapse,uncollapse:r.transitionUncollapse,halfSpeed:r.animationSpeed/2}:{show:"show",hide:"hide",speed:0,collapse:"hide",uncollapse:"show",halfSpeed:0}};u.getTabs=function(){var t;u.tabs=f.find(r.tabs);u.panels=n();u.tabs.each(function(){var f=n(this),e=f.children("a"),i=f.children("a").data("target");f.data("easytabs",{});i!==undefined&&i!==null?f.data("easytabs").ajax=e.attr("href"):i=e.attr("href");i=i.match(/#([^\?]+)/)[1];t=r.panelContext.find("#"+i);t.length?(t.data("easytabs",{position:t.css("position"),visibility:t.css("visibility")}),t.not(r.panelActiveClass).hide(),u.panels=u.panels.add(t),f.data("easytabs").panel=t):(u.tabs=u.tabs.not(f),"console"in window&&console.warn("Warning: tab without matching panel for selector '#"+i+"' removed from set"))})};u.selectTab=function(n,t){var e=window.location,o=e.hash.match(/^[^\?]*/)[0],i=n.parent().data("easytabs").panel,f=n.parent().data("easytabs").ajax;r.collapsible&&!s&&(n.hasClass(r.tabActiveClass)||n.hasClass(r.collapsedClass))?u.toggleTabCollapse(n,i,f,t):n.hasClass(r.tabActiveClass)&&i.hasClass(r.panelActiveClass)?r.cache||a(n,i,f,t):a(n,i,f,t)};u.toggleTabCollapse=function(n,t,i,e){u.panels.stop(!0,!0);l(f,"easytabs:before",[n,t,r])&&(u.tabs.filter("."+r.tabActiveClass).removeClass(r.tabActiveClass).children().removeClass(r.tabActiveClass),n.hasClass(r.collapsedClass)?(!i||r.cache&&n.parent().data("easytabs").cached||(f.trigger("easytabs:ajax:beforeSend",[n,t]),t.load(i,function(i,r,u){n.parent().data("easytabs").cached=!0;f.trigger("easytabs:ajax:complete",[n,t,i,r,u])})),n.parent().removeClass(r.collapsedClass).addClass(r.tabActiveClass).children().removeClass(r.collapsedClass).addClass(r.tabActiveClass),t.addClass(r.panelActiveClass)[o.uncollapse](o.speed,r.transitionUncollapseEasing,function(){f.trigger("easytabs:midTransition",[n,t,r]);typeof e=="function"&&e()})):(n.addClass(r.collapsedClass).parent().addClass(r.collapsedClass),t.removeClass(r.panelActiveClass)[o.collapse](o.speed,r.transitionCollapseEasing,function(){f.trigger("easytabs:midTransition",[n,t,r]);typeof e=="function"&&e()})))};u.matchTab=function(n){return u.tabs.find("[href='"+n+"'],[data-target='"+n+"']").first()};u.matchInPanel=function(n){return n&&u.validId(n)?u.panels.filter(":has("+n+")").first():[]};u.validId=function(n){return n.substr(1).match(/^[A-Za-z]+[A-Za-z0-9\-_:\.].$/)};u.selectTabFromHashChange=function(){var n=window.location.hash.match(/^[^\?]*/)[0],t=u.matchTab(n),i;r.updateHash&&(t.length?(s=!0,u.selectTab(t)):(i=u.matchInPanel(n),i.length?(n="#"+i.attr("id"),t=u.matchTab(n),s=!0,u.selectTab(t)):e.hasClass(r.tabActiveClass)||r.cycle||(n===""||u.matchTab(c).length||f.closest(n).length)&&(s=!0,u.selectTab(h))))};u.cycleTabs=function(t){r.cycle&&(t=t%u.tabs.length,$tab=n(u.tabs[t]).children("a").first(),s=!0,u.selectTab($tab,function(){setTimeout(function(){u.cycleTabs(t+1)},r.cycle)}))};u.publicMethods={select:function(t){var i;(i=u.tabs.filter(t)).length===0?(i=u.tabs.find("a[href='"+t+"']")).length===0&&(i=u.tabs.find("a"+t)).length===0&&(i=u.tabs.find("[data-target='"+t+"']")).length===0&&(i=u.tabs.find("a[href$='"+t+"']")).length===0&&n.error("Tab '"+t+"' does not exist in tab set"):i=i.children("a").first();u.selectTab(i)}};var l=function(t,i,r){var u=n.Event(i);return t.trigger(u,r),u.result!==!1},p=function(){f.addClass(r.containerClass);u.tabs.parent().addClass(r.tabsClass);u.tabs.addClass(r.tabClass);u.panels.addClass(r.panelClass)},w=function(){var t=window.location.hash.match(/^[^\?]*/)[0],i=u.matchTab(t).parent(),f;i.length===1?(e=i,r.cycle=!1):(f=u.matchInPanel(t),f.length?(t="#"+f.attr("id"),e=u.matchTab(t).parent()):(e=u.tabs.parent().find(r.defaultTab),e.length===0&&n.error("The specified default tab ('"+r.defaultTab+"') could not be found in the tab set ('"+r.tabs+"') out of "+u.tabs.length+" tabs.")));h=e.children("a").first();b(i)},b=function(t){var i,u;r.collapsible&&t.length===0&&r.collapsedByDefault?e.addClass(r.collapsedClass).children().addClass(r.collapsedClass):(i=n(e.data("easytabs").panel),u=e.data("easytabs").ajax,!u||r.cache&&e.data("easytabs").cached||(f.trigger("easytabs:ajax:beforeSend",[h,i]),i.load(u,function(n,t,r){e.data("easytabs").cached=!0;f.trigger("easytabs:ajax:complete",[h,i,n,t,r])})),e.data("easytabs").panel.show().addClass(r.panelActiveClass),e.addClass(r.tabActiveClass).children().addClass(r.tabActiveClass));f.trigger("easytabs:initialised",[h,i])},k=function(){u.tabs.children("a").bind(r.bind_str,function(t){r.cycle=!1;s=!1;u.selectTab(n(this));t.preventDefault?t.preventDefault():t.returnValue=!1})},a=function(n,t,i,e){if(u.panels.stop(!0,!0),l(f,"easytabs:before",[n,t,r])){var v=u.panels.filter(":visible"),h=t.parent(),p,w,a,y,b=window.location.hash.match(/^[^\?]*/)[0];r.animate&&(p=d(t),w=v.length?g(v):0,a=p-w);c=b;y=function(){f.trigger("easytabs:midTransition",[n,t,r]);r.animate&&r.transitionIn=="fadeIn"&&a<0&&h.animate({height:h.height()+a},o.halfSpeed).css({"min-height":""});r.updateHash&&!s?window.location.hash="#"+t.attr("id"):s=!1;t[o.show](o.speed,r.transitionInEasing,function(){h.css({height:"","min-height":""});f.trigger("easytabs:after",[n,t,r]);typeof e=="function"&&e()})};!i||r.cache&&n.parent().data("easytabs").cached||(f.trigger("easytabs:ajax:beforeSend",[n,t]),t.load(i,function(i,r,u){n.parent().data("easytabs").cached=!0;f.trigger("easytabs:ajax:complete",[n,t,i,r,u])}));r.animate&&r.transitionOut=="fadeOut"&&(a>0?h.animate({height:h.height()+a},o.halfSpeed):h.css({"min-height":h.height()}));u.tabs.filter("."+r.tabActiveClass).removeClass(r.tabActiveClass).children().removeClass(r.tabActiveClass);u.tabs.filter("."+r.collapsedClass).removeClass(r.collapsedClass).children().removeClass(r.collapsedClass);n.parent().addClass(r.tabActiveClass).children().addClass(r.tabActiveClass);u.panels.filter("."+r.panelActiveClass).removeClass(r.panelActiveClass);t.addClass(r.panelActiveClass);v.length?v[o.hide](o.speed,r.transitionOutEasing,y):t[o.uncollapse](o.speed,r.transitionUncollapseEasing,y)}},d=function(t){if(t.data("easytabs")&&t.data("easytabs").lastHeight)return t.data("easytabs").lastHeight;var u=t.css("display"),i,r;try{i=n("<div><\/div>",{position:"absolute",visibility:"hidden",overflow:"hidden"})}catch(f){i=n("<div><\/div>",{visibility:"hidden",overflow:"hidden"})}return r=t.wrap(i).css({position:"relative",visibility:"hidden",display:"block"}).outerHeight(),t.unwrap(),t.css({position:t.data("easytabs").position,visibility:t.data("easytabs").visibility,display:u}),t.data("easytabs").lastHeight=r,r},g=function(n){var t=n.outerHeight();return n.data("easytabs")?n.data("easytabs").lastHeight=t:n.data("easytabs",{lastHeight:t}),t},nt=function(){typeof n(window).hashchange=="function"?n(window).hashchange(function(){u.selectTabFromHashChange()}):n.address&&typeof n.address.change=="function"&&n.address.change(function(){u.selectTabFromHashChange()})},tt=function(){var n;r.cycle&&(n=u.tabs.index(e),setTimeout(function(){u.cycleTabs(n+1)},r.cycle))};u.init()};n.fn.easytabs=function(t){var i=arguments;return this.each(function(){var u=n(this),r=u.data("easytabs");return undefined===r&&(r=new n.easytabs(this,t),u.data("easytabs",r)),r.publicMethods[t]?r.publicMethods[t](Array.prototype.slice.call(i,1)):void 0})}})(jQuery);